
        <!DOCTYPE html>
        <html lang="pl">
        <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>Grafik Służby</title>
            
        <style>
            body { font-family: Arial, sans-serif; margin: 0; padding: 0px; background: #f5f5f5; }
            .program-print { font-size: 0.6em; max-width: 1000px; margin: auto auto; background: white; border-radius: 0px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); padding: 10px; }
            .program-title { text-align: center; font-size: 1.5em; font-weight: bold; margin-bottom: 20px; margin-top: 20px; color: #4E7C82; }
            table { width: 100%; border-collapse: collapse;}
            th, td { padding: 10px 5px; text-align: left; border-bottom: 1px solid #ddd; }
            th { background-color: #353535; color: white; font-size: 0.9em; text-transform: uppercase;}
            tbody tr:nth-child(even) { background-color: #f8f9fa; }
            td:first-child { font-weight: bold; color: #4E7C82; }
            .footer { text-align: center; margin-top: 20px; font-size: 0.8em; color: #888; }
            .preview-item { margin-bottom: 2rem; page-break-inside: avoid; }
            .highlight-next {
                background-color: #d1eaed !important;
            }

            @media (min-width: 768px) {
                .program-print {
                    font-size: 0.9em;
                }
            }
        </style>
    
        </head>
        <body>
            <div class="program-print">
                
                <div class="preview-item">
                <div class="program-title">GRAFIK SŁUŻBY PORZĄDKOWEJ - grudzień 2025</div>
                <table><thead><tr><th>Data</th><th>Porządkowy Sala</th><th>Porządkowy Hol</th></tr></thead><tbody><tr>
            <td>04.12<br>czwartek</td>
            <td><strong>Dariusz Bartoszek</strong></td>
            <td><strong>Marcin Gorzel</strong><br><strong>Mirosław Kozioł</strong></td>
        </tr><tr>
            <td>07.12<br>niedziela</td>
            <td><strong>Sławomir Kaproń</strong></td>
            <td><strong>Mateusz Mazurek</strong><br><strong>Marek Sierociński</strong></td>
        </tr><tr>
            <td>11.12<br>czwartek</td>
            <td><strong>Wiesław Sierociński</strong></td>
            <td><strong>Jan Mazurek</strong><br><strong>Sławomir Kaproń</strong></td>
        </tr><tr>
            <td>14.12<br>niedziela</td>
            <td><strong>Marcin Gorzel</strong></td>
            <td><strong>Marcel Sałatka</strong><br><strong>Wiesław Sierociński</strong></td>
        </tr><tr>
            <td>18.12<br>czwartek</td>
            <td><strong>Dobromir Kuśmierz</strong></td>
            <td><strong>Dariusz Bartoszek</strong><br><strong>Robert Warda</strong></td>
        </tr><tr>
            <td>21.12<br>niedziela</td>
            <td><strong>Jan Mazurek</strong></td>
            <td><strong>Zbigniew Gorzel</strong><br><strong>Wiesław Furtak</strong></td>
        </tr><tr>
            <td>25.12<br>czwartek</td>
            <td><strong>Marcel Sałatka</strong></td>
            <td><strong>Dobromir Kuśmierz</strong><br><strong>Mirosław Kozioł</strong></td>
        </tr><tr>
            <td>28.12<br>niedziela</td>
            <td><strong>Sławomir Kaproń</strong></td>
            <td><strong>Dariusz Bartoszek</strong><br><strong>Jan Mazurek</strong></td>
        </tr></tbody></table>
            </div>
                 <div class="footer">
                    Wygenerowano: 30.11.2025, 14:03:46
                </div>
            </div>
            
        <script>
            document.addEventListener('DOMContentLoaded', function() {
                try {
                    const titleElements = document.querySelectorAll('.program-title');
                    if (titleElements.length === 0) return;

                    let scheduleYear = null;
                    for (const titleEl of titleElements) {
                        const yearMatch = titleEl.textContent.match(/\b(\d{4})\b/);
                        if (yearMatch) {
                            scheduleYear = parseInt(yearMatch[1], 10);
                            break;
                        }
                    }
                    if (!scheduleYear) return;

                    const today = new Date();
                    today.setHours(0, 0, 0, 0);

                    const rows = document.querySelectorAll('tbody tr');
                    let nextMeetingRow = null;
                    let minTimeDiff = Infinity;

                    rows.forEach(row => {
                        const dateCell = row.querySelector('td');
                        if (dateCell) {
                            const dateText = dateCell.innerHTML.split('<br>')[0].trim();
                            const [day, month] = dateText.split('.').map(Number);
                            
                            const rowDate = new Date(Date.UTC(scheduleYear, month - 1, day));
                            const timeDiff = rowDate.getTime() - today.getTime();

                            if (timeDiff >= 0 && timeDiff < minTimeDiff) {
                                minTimeDiff = timeDiff;
                                nextMeetingRow = row;
                            }
                        }
                    });

                    if (nextMeetingRow) {
                        nextMeetingRow.classList.add('highlight-next');
                    }
                } catch (e) {
                    console.error("Błąd w skrypcie wyróżniającym:", e);
                }
            });
        </script>
    
        </body>
        </html>